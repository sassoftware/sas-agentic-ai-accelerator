{"creationTimeStamp":"2024-08-03T14:02:06.235Z","modifiedTimeStamp":"2024-08-04T12:12:21.700Z","createdBy":"gerdaw","modifiedBy":"gerdaw","name":"MM - Get Models in Project.step","displayName":"MM - Get Models in Project.step","localDisplayName":"MM - Get Models in Project.step","description":"Retrieves a list of all available models in a SAS Model Manager project that are available to you in the current SAS Viya environment.","localDescription":"Retrieves a list of all available models in a SAS Model Manager project that are available to you in the current SAS Viya environment.","properties":{},"links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","uri":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","uri":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","uri":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","uri":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb"},{"method":"POST","rel":"copy","href":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb/copy","uri":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb/copy","responseType":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","uri":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","uri":"/dataFlows/steps/2e7f9976-f4dc-4b6c-afeb-35bc39d3cdcb","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":0.0,"version":2,"type":"code","flowMetadata":{"inputPorts":[{"name":"_mgm_rep_input","displayName":"_mgm_rep_input","localDisplayName":"_mgm_rep_input","minEntries":0,"maxEntries":1,"defaultEntries":0,"type":"table"}],"outputPorts":[{"name":"_mgm_output","displayName":"_mgm_output","localDisplayName":"_mgm_output","description":"The table contains a list of all available models within a SAS Model Manager project","localDescription":"The table contains a list of all available models within a SAS Model Manager project","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table","columnDelta":{"updateColumnArguments":["_mgm_id","_mgm_projectID","_mgm_repositoryId","_mgm_name","_mgm_function","_mgm_role","_mgm_createdBy","_mgm_creationTS","_mgm_modifiedBy","_mgm_modifiedTS"]},"supportsView":false,"requiresStructure":false}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"pageDefinition\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Definition\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgm_info_text\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"For the project ID you can either connect a table, which has to have a column named id, that contains the project ID or you can manually enter an ID value.\\n\\nConnect an output table that will contain all available models in a SAS Model Manager project in the SAS Viya environment, that you have access to.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgm_input_selector\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Choose how to enter the project ID:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"table\",\n\t\t\t\t\t\t\t\"label\": \"Select ID from a table\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"manual\",\n\t\t\t\t\t\t\t\"label\": \"Input an ID manually\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgm_rep_input\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Project table:\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_mgm_input_selector\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgm_col\",\n\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\"label\": \"Select project ID column:\",\n\t\t\t\t\t\"include\": null,\n\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\"columntype\": \"c\",\n\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\"min\": null,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_mgm_input_selector\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t],\n\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\"table\": \"_mgm_rep_input\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgm_repID_table\",\n\t\t\t\t\t\"type\": \"list\",\n\t\t\t\t\t\"label\": \"Select the project ID:\",\n\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\"ref\": \"_mgm_col\"\n\t\t\t\t\t},\n\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\"min\": null,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_mgm_input_selector\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgm_repID_manual\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"Enter a project ID:\",\n\t\t\t\t\t\"placeholder\": \"Project ID\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_mgm_input_selector\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"manual\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgm_output\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Output models table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgm_output_definition\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Output definition\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": false,\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgm_id\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Model ID:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgm_projectID\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Project ID:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgm_repositoryId\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Repository ID:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgm_name\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Name:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgm_function\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Function:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgm_role\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Role:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgm_createdBy\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Created by:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgm_creationTS\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Creation time stamp:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgm_modifiedBy\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Modified by:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgm_modifiedTS\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Modification time stamp:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"pageAbout\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"textAbout\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"MM - Get Models in Project step\\n==========\\n\\nThe \\\"MM - Get Models in Project\\\" custom steps performs a look up of all of the available  models in a SAS Model Manager (MM) project that the step user has access to.\\n\\nThis step requires as an input the ID of a project, to retrieve a list of project IDs use the MM - Get Projects in Repository step.\\n\\nThis steps output can be used as input for the steps MM - Get Model Information.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionPrereqs\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Pre-requisites\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textPrereqs\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"Pre-requisites:  Tested on Viya version Stable 2024.07\\n\\nSAS Model Manager has be licensed and the user has to have the capability to use SAS Model Manager.\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionDocumentation\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Documentation\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textDocumentation\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"* The following SAS Viya REST-API is used: https://developer.sas.com/rest-apis/modelRepository-v8?operation=getProjectModels\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionChangelog\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Changelog\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textChangelog\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"* Version: 1.0 (03AUG2024)\\n      - Initial version\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"_mgm_input_selector\": {\n\t\t\t\"value\": \"table\",\n\t\t\t\"label\": \"Select ID from a table\"\n\t\t},\n\t\t\"_mgm_rep_input\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"_mgm_col\": [],\n\t\t\"_mgm_repID_table\": [],\n\t\t\"_mgm_repID_manual\": \"\",\n\t\t\"_mgm_output\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"_mgm_id\": {\n\t\t\t\"value\": \"id\",\n\t\t\t\"label\": \"ID of the model\",\n\t\t\t\"length\": 36\n\t\t},\n\t\t\"_mgm_projectID\": {\n\t\t\t\"value\": \"projectId\",\n\t\t\t\"label\": \"ID of the project that the model is in\",\n\t\t\t\"length\": 36\n\t\t},\n\t\t\"_mgm_repositoryId\": {\n\t\t\t\"value\": \"repositoryId\",\n\t\t\t\"label\": \"ID of the repository that the project is in\",\n\t\t\t\"length\": 36\n\t\t},\n\t\t\"_mgm_name\": {\n\t\t\t\"value\": \"name\",\n\t\t\t\"label\": \"Name of the model\",\n\t\t\t\"length\": 256\n\t\t},\n\t\t\"_mgm_function\": {\n\t\t\t\"value\": \"function\",\n\t\t\t\"label\": \"Function of the model\",\n\t\t\t\"length\": 256\n\t\t},\n\t\t\"_mgm_role\": {\n\t\t\t\"value\": \"role\",\n\t\t\t\"label\": \"Indicates the role of the model in the project, i.e. Challenger or Champion\",\n\t\t\t\"length\": 256\n\t\t},\n\t\t\"_mgm_createdBy\": {\n\t\t\t\"value\": \"createdBy\",\n\t\t\t\"label\": \"Project creator\",\n\t\t\t\"length\": 256\n\t\t},\n\t\t\"_mgm_creationTS\": {\n\t\t\t\"value\": \"creationTimeStamp\",\n\t\t\t\"label\": \"Time of project creation\",\n\t\t\t\"length\": 27\n\t\t},\n\t\t\"_mgm_modifiedBy\": {\n\t\t\t\"value\": \"modifiedBy\",\n\t\t\t\"label\": \"Last project modifier\",\n\t\t\t\"length\": 256\n\t\t},\n\t\t\"_mgm_modifiedTS\": {\n\t\t\t\"value\": \"modifiedTimeStamp\",\n\t\t\t\"label\": \"Time of last project modification\",\n\t\t\t\"length\": 27\n\t\t}\n\t}\n}","templates":{"SAS":"/**************************************************************\n    Get a list of Models in a SAS Model Manager Project\n\n    mgm is short for:\n      Model Manager Get Models\n**************************************************************/\n* Get the Viya Host URL;\n%let _mgm_viyaHost=%sysfunc(getoption(SERVICESBASEURL));\n\n%if &_mgm_input_selector. EQ table %then %do;\n\t%let _mgm_project_id = &_mgm_repid_table_1.;\n%end;\n%else %do;\n\t%let _mgm_project_id = &_mgm_repid_manual.;\n%end;\n\n* Macro to recursivly get all models in a project;\n%macro _mgm_model_pagination(_mgm_start=0, _mgm_limit=25);\n    %local _mgm_start\n        _mgm_limit\n        _mgm_ds_nobs\n        _mgm_nvar\n        _mgm_new_start;\n\n    filename _mgm_rp temp;\n\n    * https://developer.sas.com/rest-apis/modelRepository-v8?operation=getProjectModels;\n    proc http method = 'Get'\n        url = \"&_mgm_viyaHost./modelRepository/projects/&_mgm_project_id./models?start=&_mgm_start%nrstr(&)limit=&_mgm_limit.\"\n        oauth_bearer = sas_services\n        out = _mgm_rp;\n        headers 'Accept' = 'application/json';\n    quit;\n\n    libname _mgm_rp json;\n\n    * Get the number of observations where one obs = one model;\n    proc sql noprint;\n        select count(*) into :_mgm_ds_nobs trimmed from _mgm_rp.items;\n    quit;\n\n    * Get the number of columns;\n    proc sql noprint;\n        select nvar into :_mgm_nvar trimmed from dictionary.tables where\n            libname='_MGM_RP' and memname='ITEMS';\n    quit;\n\n    * Handle the first iteration and subsequent requests;\n    %if &_mgm_start. eq 0 %then %do;\n        data &_mgm_output.;\n            length name createdBy modifiedBy function role $256.;\n            set _mgm_rp.items(keep=id projectId repositoryId name function role createdBy creationTimeStamp modifiedBy modifiedTimeStamp);\n        run;\n    %end;\n    %else %do;\n        %if &_mgm_nvar. gt 2 %then %do;\n            proc append force nowarn base=&_mgm_output.\n                data=_mgm_rp.items(keep=id projectId repositoryId name function role createdBy creationTimeStamp modifiedBy modifiedTimeStamp);\n            quit;\n        %end;\n    %end;\n\n    libname _mgm_rp clear;\n    filename _mgm_rp clear;\n\n    * Check if another iteration is needed;\n    %if &_mgm_ds_nobs eq &_mgm_limit and &_mgm_nvar. gt 2 %then %do;\n        %put NOTE: Getting more models;\n        %let _mgm_new_start=%eval(&_mgm_start. + &_mgm_limit.);\n        %_mgm_model_pagination(_mgm_start=&_mgm_new_start., _mgm_limit=&_mgm_limit.);\n    %end;\n%mend _mgm_model_pagination;\n\n* Get a table of all models;\n%_mgm_model_pagination();\n\n* Clean up;\n%symdel _mgm_viyaHost _mgm_project_id;\n%sysmacdelete _mgm_model_pagination;"}}