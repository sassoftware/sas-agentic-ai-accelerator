{"creationTimeStamp":"2025-08-11T06:16:15.163583Z","createdBy":"gerdaw","modifiedTimeStamp":"2025-08-11T06:28:18.605877Z","modifiedBy":"gerdaw","name":"LLM - Get All Prompts.step","displayName":"LLM - Get All Prompts.step","localDisplayName":"LLM - Get All Prompts.step","description":"This step collects all the prompting projects, prompt templates and prompt experiments from SAS Model Manager and turns them into one unified table for reporting.\n\nThe output table has to be a CAS table, as it will be used in SAS Visual Analytics.","localDescription":"This step collects all the prompting projects, prompt templates and prompt experiments from SAS Model Manager and turns them into one unified table for reporting.\n\nThe output table has to be a CAS table, as it will be used in SAS Visual Analytics.","links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","uri":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","uri":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","uri":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","uri":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3"},{"method":"POST","rel":"copy","href":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3/copy","uri":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3/copy","responseType":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","uri":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","uri":"/dataFlows/steps/b627b397-8b97-49b4-aa87-a5121e3e7de3","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":1,"version":2,"type":"code","flowMetadata":{"outputPorts":[{"name":"_gap_output","displayName":"_gap_output","localDisplayName":"_gap_output","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table"}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"pageOptions\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Options\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"text1\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"This step collects all the prompting projects, prompt templates and prompt experiments from SAS Model Manager and turns them into one unified table for reporting.\\n\\nThe output table has to be a CAS table, as it will be used in SAS Visual Analytics. If there is an existing table is will be dropped, the new table will be promoted to global scope and replace a previous save of the table.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_gap_output\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Prompt experiment CAS table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"PROMPT_EXPERIMENTS\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"pageAbout\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"textAbout\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"LLM - Get All Prompts step\\n==========\\n\\nThe \\\"Get All Prompts\\\" custom steps collects all the prompting projects, prompt templates and prompt experiments from SAS Model Manager and turns them into one unified table for reporting.\\n\\nOutput table has to be a CAS table.\\n\\nThis step makes use of Proc HTTP to call the /modelRepository and /files endpoints of your SAS Viya server.\\n\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionPrereqs\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Pre-requisites\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textPrereqs\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"Pre-requisites:  Tested on Viya version Stable 2025.07\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionDocumentation\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Documentation\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textDocumentation\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"* https://developer.sas.com/rest-apis/modelRepository-v8\\n* https://developer.sas.com/rest-apis/files\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionChangelog\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Changelog\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textChangelog\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"* Version: 1.0 (09AUG2025)\\n      - Initial version\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"_gap_output\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t}\n\t}\n}","localUi":"{\"pages\":[{\"children\":[{\"id\":\"text1\",\"text\":\"This step collects all the prompting projects, prompt templates and prompt experiments from SAS Model Manager and turns them into one unified table for reporting.\\n\\nThe output table has to be a CAS table, as it will be used in SAS Visual Analytics. If there is an existing table is will be dropped, the new table will be promoted to global scope and replace a previous save of the table.\",\"type\":\"text\",\"visible\":\"\"},{\"id\":\"_gap_output\",\"label\":\"Prompt experiment CAS table:\",\"placeholder\":\"PROMPT_EXPERIMENTS\",\"required\":true,\"type\":\"outputtable\",\"visible\":\"\"}],\"id\":\"pageOptions\",\"label\":\"Options\",\"type\":\"page\"},{\"children\":[{\"id\":\"textAbout\",\"text\":\"LLM - Get All Prompts step\\n==========\\n\\nThe \\\"Get All Prompts\\\" custom steps collects all the prompting projects, prompt templates and prompt experiments from SAS Model Manager and turns them into one unified table for reporting.\\n\\nOutput table has to be a CAS table.\\n\\nThis step makes use of Proc HTTP to call the /modelRepository and /files endpoints of your SAS Viya server.\\n\",\"type\":\"text\",\"visible\":\"\"},{\"children\":[{\"id\":\"textPrereqs\",\"text\":\"Pre-requisites:  Tested on Viya version Stable 2025.07\",\"type\":\"text\",\"visible\":\"\"}],\"id\":\"sectionPrereqs\",\"label\":\"Pre-requisites\",\"open\":false,\"type\":\"section\",\"visible\":\"\"},{\"children\":[{\"id\":\"textDocumentation\",\"text\":\"* https://developer.sas.com/rest-apis/modelRepository-v8\\n* https://developer.sas.com/rest-apis/files\",\"type\":\"text\",\"visible\":\"\"}],\"id\":\"sectionDocumentation\",\"label\":\"Documentation\",\"open\":false,\"type\":\"section\",\"visible\":\"\"},{\"children\":[{\"id\":\"textChangelog\",\"text\":\"* Version: 1.0 (09AUG2025)\\n      - Initial version\",\"type\":\"text\",\"visible\":\"\"}],\"id\":\"sectionChangelog\",\"label\":\"Changelog\",\"open\":true,\"type\":\"section\",\"visible\":\"\"}],\"id\":\"pageAbout\",\"label\":\"About\",\"type\":\"page\"}],\"showPageContentOnly\":true,\"syntaxversion\":\"1.3.0\",\"values\":{\"_gap_output\":{\"library\":\"\",\"table\":\"\"}}}","templates":{"SAS":"* gap is short for get all prompts;\r\n* Set the Tag which is used for filtering for projects;\r\n%let _gap_tag = Prompt-Engineering;\r\n\r\n* Get the Viya Host URL;\r\n%let _gap_viyaHost=%sysfunc(getoption(SERVICESBASEURL));\r\n\r\n* Macro to recursivly get all projects;\r\n%macro _gap_project_pagination(_gap_start=0, _gap_limit=25);\r\n    %local _gap_start\r\n        _gap_limit\r\n        _gap_ds_nobs\r\n        _gap_nvar\r\n        _gap_new_start;\r\n\r\n    filename _gap_rp temp;\r\n\r\n    * https://developer.sas.com/rest-apis/modelRepository-v8?operation=getProjects;\r\n    proc http method = 'Get'\r\n        url = \"&_gap_viyaHost./modelRepository/projects?start=&_gap_start%nrstr(&)limit=&_gap_limit.%nrstr(&)filter=eq(tags,'&_gap_tag.')\"\r\n        oauth_bearer = sas_services\r\n        out = _gap_rp;\r\n        headers 'Accept' = 'application/json';\r\n    quit;\r\n\r\n    libname _gap_rp json;\r\n\r\n    * Get the number of observations where one obs = one project;\r\n    proc sql noprint;\r\n        select count(*) into :_gap_ds_nobs trimmed from _gap_rp.items;\r\n    quit;\r\n\r\n    * Get the number of columns;\r\n    proc sql noprint;\r\n        select nvar into :_gap_nvar trimmed from dictionary.tables where\r\n            libname='_GAP_RP' and memname='ITEMS';\r\n    quit;\r\n\r\n    * Handle the first iteration and subsequent requests;\r\n    %if &_gap_start. eq 0 %then %do;\r\n        data work._gap_all_projects;\r\n            length name createdBy modifiedBy function status $256.;\r\n            set _gap_rp.items(keep=id repositoryId name function status folderId createdBy creationTimeStamp modifiedBy modifiedTimeStamp);\r\n        run;\r\n    %end;\r\n    %else %do;\r\n        %if &_gap_nvar. gt 2 %then %do;\r\n            proc append force nowarn base=work._gap_all_projects\r\n                data=_gap_rp.items(keep=id repositoryId name function status folderId createdBy creationTimeStamp modifiedBy modifiedTimeStamp);\r\n            quit;\r\n        %end;\r\n    %end;\r\n\r\n    libname _gap_rp clear;\r\n    filename _gap_rp clear;\r\n\r\n    * Check if another iteration is needed;\r\n    %if &_gap_ds_nobs eq &_gap_limit and &_gap_nvar. gt 2 %then %do;\r\n        %put NOTE: Getting more projects;\r\n        %let _gap_new_start=%eval(&_gap_start. + &_gap_limit.);\r\n        %_gap_project_pagination(_gap_start=&_gap_new_start., _gap_limit=&_gap_limit.);\r\n    %end;\r\n%mend _gap_project_pagination;\r\n\r\n* Get a table of all projects;\r\n%_gap_project_pagination();\r\n\r\n* Macro to recursivly get all models in a project;\r\n%macro _gap_model_pagination(_gap_project_id, _gap_start=0, _gap_limit=100);\r\n    %local _gap_start\r\n        _gap_limit\r\n        _gap_ds_nobs\r\n        _gap_nvar\r\n        _gap_new_start;\r\n\r\n    filename _gap_rp temp;\r\n\r\n    * https://developer.sas.com/rest-apis/modelRepository-v8?operation=getProjects;\r\n    proc http method = 'Get'\r\n        url = \"&_gap_viyaHost./modelRepository/projects/&_gap_project_id./models?start=&_gap_start%nrstr(&)limit=&_gap_limit.\"\r\n        oauth_bearer = sas_services\r\n        out = _gap_rp;\r\n        headers 'Accept' = 'application/json';\r\n    quit;\r\n\r\n    libname _gap_rp json;\r\n\r\n    * Get the number of observations where one obs = one model;\r\n    proc sql noprint;\r\n        select count(*) into :_gap_ds_nobs trimmed from _gap_rp.items;\r\n    quit;\r\n\r\n    * Get the number of columns;\r\n    proc sql noprint;\r\n        select nvar into :_gap_nvar trimmed from dictionary.tables\r\n            where libname='_GAP_RP' and memname='ITEMS';\r\n    quit;\r\n\r\n    %if &_gap_nvar. gt 2 %then %do;\r\n        * Check for description;\r\n        proc sql noprint;\r\n            select * from dictionary.columns\r\n                where libname='_GAP_RP' and memname='ITEMS' and name='description';\r\n        quit;\r\n\r\n        %if &SQLOBS. %then %do;\r\n            proc append force nowarn base=work._gap_all_models\r\n                data=_gap_rp.items(keep=id projectId repositoryId name description function createdBy creationTimeStamp modifiedBy modifiedTimeStamp);\r\n            quit;\r\n        %end;\r\n        %else %do;\r\n            proc append force nowarn base=work._gap_all_models\r\n                data=_gap_rp.items(keep=id projectId repositoryId name function createdBy creationTimeStamp modifiedBy modifiedTimeStamp);\r\n            quit;\r\n        %end;\r\n    %end;\r\n\r\n    libname _gap_rp clear;\r\n    filename _gap_rp clear;\r\n\r\n    * Check if another iteration is needed;\r\n    %if &_gap_ds_nobs eq &_gap_limit and &_gap_nvar. gt 2 %then %do;\r\n        %put NOTE: Getting more models;\r\n        %let _gap_new_start=%eval(&_gap_start. + &_gap_limit.);\r\n        %_gap_model_pagination(&_gap_project_id., _gap_start=&_gap_new_start., _gap_limit=&_gap_limit.);\r\n    %end;\r\n%mend _gap_model_pagination;\r\n\r\n* Get a table of all models in a project;\r\ndata work._gap_all_models;\r\n    length name description createdBy modifiedBy function $256. id projectId repositoryId $36. creationTimeStamp modifiedTimeStamp $24.;\r\nrun;\r\n\r\ndata _null_;\r\n    set work._gap_all_projects(keep=id);\r\n    args = '%nrstr(%_gap_model_pagination(' || id || '))';\r\n    call execute(args);\r\nrun;\r\n\r\n* Macro to retrieve the Prompt-Experiement-Tracker.json and other metadata;\r\n%macro _gap_pet_data(_gap_model_id, _gap_start=0, _gap_limit=100);\r\n    %local _gap_model_id\r\n        _gap_start\r\n        _gap_limit\r\n        _gap_ds_nobs\r\n        _gap_nvar\r\n        _gap_tracker_uri;\r\n\r\n    filename _gap_rp temp;\r\n\r\n    * https://developer.sas.com/rest-apis/modelRepository-v8/getModelContents;\r\n    proc http method = 'Get'\r\n        url = \"&_gap_viyaHost./modelRepository/models/&_gap_model_id./contents?start=&_gap_start%nrstr(&)limit=&_gap_limit.\"\r\n        oauth_bearer = sas_services\r\n        out = _gap_rp;\r\n        headers 'Accept' = 'application/json';\r\n    quit;\r\n\r\n    libname _gap_rp json;\r\n\r\n    * Get the number of observations where one obs = one model;\r\n    proc sql noprint;\r\n        select count(*) into :_gap_ds_nobs trimmed from _gap_rp.items;\r\n    quit;\r\n\r\n    * Get the number of columns;\r\n    proc sql noprint;\r\n        select nvar into :_gap_nvar trimmed from dictionary.tables\r\n            where libname='_GAP_RP' and memname='ITEMS';\r\n    quit;\r\n\r\n    %if &_gap_nvar. gt 2 %then %do;\r\n        * Check for a Prompt Experiment Tracker file;\r\n        proc sql noprint;\r\n            select fileUri into :_gap_tracker_uri trimmed from _gap_rp.items\r\n                where name='Prompt-Experiment-Tracker.json';\r\n        quit;\r\n        \r\n        %if &SQLOBS. %then %do;\r\n            filename _gap_pe temp;\r\n            \r\n            * https://developer.sas.com/rest-apis/files/getfileContentForGivenId;\r\n            proc http method='Get'\r\n                url=\"&_gap_viyaHost.&_gap_tracker_uri./content\"\r\n                oauth_bearer = sas_services\r\n                out = _gap_pe;\r\n                headers 'Accept' = 'application/json';\r\n            quit;\r\n\r\n            libname _gap_pe json;\r\n\r\n            data work._gap_all_experiments_temp(drop=systemPromptTEMP userPromptTEMP);\r\n                length modelID $36. runID 8. systemPrompt systemPromptTEMP userPrompt userPromptTEMP $32767. model $64. options $256. response $32767. run_time prompt_length output_length best_prompt fastest_prompt fewest_tokens_prompt 8.;\r\n                set _gap_pe.root(drop=ordinal_root);\r\n\r\n                modelID = \"&_gap_model_id.\";\r\n\r\n                * Set system and user prompt;\r\n                if systemPrompt ne '' then do;\r\n                    systemPromptTEMP = systemPrompt;\r\n                    userPromptTEMP = userPrompt;\r\n                end;\r\n\r\n                if model ne '' then do;\r\n                    systemPrompt = systemPromptTEMP;\r\n                    userPrompt = userPromptTEMP;\r\n                    output;\r\n                end;\r\n                \r\n                retain systemPromptTEMP userPromptTEMP;\r\n            run;\r\n\r\n            proc append base=work._gap_all_experiments data=work._gap_all_experiments_temp force nowarn;\r\n            quit;\r\n\r\n            proc datasets lib=work nolist;\r\n                delete _gap_all_experiments_temp;\r\n            quit;\r\n\r\n            libname _gap_pe clear;\r\n            filename _gap_pe clear;\r\n        %end;\r\n    %end;\r\n\r\n    libname _gap_rp clear;\r\n    filename _gap_rp clear;\r\n\r\n    * Check if another iteration is needed;\r\n    %if &_gap_ds_nobs eq &_gap_limit and &_gap_nvar. gt 2 %then %do;\r\n        %put NOTE: Getting more models;\r\n        %let _gap_new_start=%eval(&_gap_start. + &_gap_limit.);\r\n        %_gap_pet_data(&_gap_model_id., _gap_start=&_gap_new_start., _gap_limit=&_gap_limit.);\r\n    %end;\r\n%mend _gap_pet_data;\r\n\r\n* Create base table;\r\ndata work._gap_all_experiments;\r\n    length modelID $36. runID 8. systemPrompt userPrompt $32767. model $64. options $256. response $32767. run_time prompt_length output_length best_prompt fastest_prompt fewest_tokens_prompt 8.;\r\nrun;\r\n\r\ndata work._gap_all_models;\r\n    * Drop the empty row;\r\n    set work._gap_all_models(rename=(id=modelID) firstobs=2);\r\n    args = '%nrstr(%_gap_pet_data(' || modelID || '))';\r\n    call execute(args);\r\n    drop args;\r\nrun;\r\n\r\n* Join the model and experiment into one table;\r\nproc sql;\r\n    create table work._gap_all_data as\r\n        select a.*,\r\n            b.runID,\r\n            b.model,\r\n            b.systemPrompt,\r\n            b.userPrompt,\r\n            b.options,\r\n            b.response,\r\n            b.run_time,\r\n            b.prompt_length,\r\n            b.output_length,\r\n            b.best_prompt,\r\n            b.fastest_prompt,\r\n            b.fewest_tokens_prompt\r\n            from work._gap_all_models as a\r\n                left join work._gap_all_experiments as b\r\n                    on a.modelID = b.modelID;\r\nquit;\r\n\r\n* Post-Process data for reporting;\r\ndata work._gap_all_data;\r\n    length unique_id 8.;\r\n    set work._gap_all_data(drop=repositoryId);\r\n    length creationTime modifiedTime temperature top_p top_k max_tokens api_key_required 8.;\r\n    format creationTime modifiedTime datetime22.8;\r\n    label unique_id = 'Unique ID'\r\n        name = 'Prompt Name'\r\n        description = 'Description'\r\n        createdBy = 'Created By'\r\n        modifiedBy = 'Modified By'\r\n        function = 'Function'\r\n        modelLink = 'Model Link'\r\n        projectLink = 'Project Link'\r\n        creationTime = 'Creation Time Stamp'\r\n        modifiedTime = 'Modified Time Stamp'\r\n        runID = 'Run ID'\r\n        model = 'Model'\r\n        systemPrompt = 'System Prompt'\r\n        userPrompt = 'User Prompt'\r\n        response = 'Response'\r\n        run_time = 'Run Time (s)'\r\n        prompt_length = 'Prompt Length (tokens)'\r\n        output_length = 'Output Length (tokens)'\r\n        best_prompt = 'Best Prompt in Run'\r\n        fastest_prompt = 'Fastest Prompt in Run'\r\n        fewest_tokens_prompt = 'Fewest Tokens Prompt in Run'\r\n        temperature = 'Temperature'\r\n        top_p = 'Top P'\r\n        top_k = 'Top K'\r\n        max_tokens = 'Max Tokens'\r\n        api_key_required = 'API Key Required';\r\n    \r\n    unique_id = _n_;\r\n\r\n    * Convert the timestamp into a SAS timestamp;\r\n    creationTime = input(creationTimeStamp, E8601DZ24.);\r\n    modifiedTime = input(modifiedTimeStamp, E8601DZ24.);\r\n\r\n    * Create a deep link to SAS Model Manager;\r\n    projectLink = catx('/', \"&_gap_viyaHost.\", 'SASModelManager/projects', projectID);\r\n    modelLink = catx('/', \"&_gap_viyaHost.\", 'SASModelManager/models', modelID);\r\n\r\n    * Parsing the options;\r\n    if options NE '' then do;\r\n        api_key_required = 0;\r\n        options = strip(substr(options, 2, length(options)-2));\r\n        do i = 1 to countw(options, ',');\r\n            key_value_pair = scan(options, i, ',');\r\n            key = scan(key_value_pair, 1, ':');\r\n            value = scan(key_value_pair, 2, ':');\r\n\r\n            if key = 'temperature' then temperature = input(value, 8.);\r\n            if key = 'top_k' then top_k = input(value, 8.);\r\n            if key = 'top_p' then top_p = input(value, 8.);\r\n            if key = 'max_tokens' then max_tokens = input(value, 8.);\r\n            if key = 'API_KEY' then api_key_required = 1;\r\n        end;\r\n    end;\r\n\r\n    drop creationTimeStamp modifiedTimeStamp modelID projectID options i key_value_pair key value;\r\nrun;\r\n\r\n%if \"%upcase(&_gap_output_engine)\"=\"CAS\" %then %do; \r\n   %let _gap_output_caslib=%sysfunc(getlcaslib(&_gap_output_lib)); \r\n\r\n   proc casUtil inCASlib=\"&_gap_output_caslib.\" outCASLib=\"&_gap_output_caslib.\";\r\n        dropTable casData=\"&_gap_output_name.\" quiet;\r\n        load data=work._gap_all_data casOut=\"&_gap_output_name.\";\r\n        promote casData=\"&_gap_output_name.\" casOut=\"&_gap_output_name.\";\r\n        save casData=\"&_gap_output_name.\" casOut=\"&_gap_output_name.\" replace;\r\n    quit;\r\n\r\n    %symdel _gap_output_caslib;\r\n%end;\r\n%else %do;\r\n   data _null_;\r\n      putlog \"ERROR: The selected output library does not point to a CASlib\";\r\n      abort;\r\n   run;\r\n%end;\r\n\r\n* Clean up;\r\nproc datasets lib=work nolist;\r\n    delete _gap_all_projects _gap_all_models _gap_all_experiments _gap_all_data;\r\nquit;\r\n%symdel _gap_viyaHost _gap_tag;\r\n%sysmacdelete _gap_project_pagination;\r\n%sysmacdelete _gap_model_pagination;\r\n%sysmacdelete _gap_pet_data;"},"eTag":"W/\"1754893698605877000\""}