{"creationTimeStamp":"2024-08-03T13:13:13.567Z","modifiedTimeStamp":"2024-08-03T14:45:38.433Z","createdBy":"gerdaw","modifiedBy":"gerdaw","name":"MM - Get Projects in Repository.step","displayName":"MM - Get Projects in Repository.step","localDisplayName":"MM - Get Projects in Repository.step","description":"Retrieves a list of all available projects in a SAS Model Manager repository that are available to you in the current SAS Viya environment.","localDescription":"Retrieves a list of all available projects in a SAS Model Manager repository that are available to you in the current SAS Viya environment.","properties":{},"links":[{"method":"GET","rel":"self","href":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","uri":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","type":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"alternate","href":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","uri":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","type":"application/vnd.sas.data.flow.step.summary"},{"method":"GET","rel":"up","href":"/dataFlows/steps","uri":"/dataFlows/steps","type":"application/vnd.sas.collection","itemType":"application/vnd.sas.data.flow.step.summary"},{"method":"PUT","rel":"update","href":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","uri":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","type":"application/vnd.sas.data.flow.step","responseType":"application/vnd.sas.data.flow.step"},{"method":"DELETE","rel":"delete","href":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","uri":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291"},{"method":"POST","rel":"copy","href":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291/copy","uri":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291/copy","responseType":"application/vnd.sas.data.flow.step"},{"method":"GET","rel":"transferExport","href":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","uri":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","responseType":"application/vnd.sas.transfer.object"},{"method":"PUT","rel":"transferImportUpdate","href":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","uri":"/dataFlows/steps/919e4f5e-e81f-47a3-b0c6-f3aad2394291","type":"application/vnd.sas.transfer.object","responseType":"application/vnd.sas.summary"}],"metadataVersion":0.0,"version":2,"type":"code","flowMetadata":{"inputPorts":[{"name":"_mgp_rep_input","displayName":"_mgp_rep_input","localDisplayName":"_mgp_rep_input","minEntries":0,"maxEntries":1,"defaultEntries":0,"type":"table"}],"outputPorts":[{"name":"_mgp_output","displayName":"_mgp_output","localDisplayName":"_mgp_output","description":"The table contains a list of all available SAS Model Manager projects within a repository","localDescription":"The table contains a list of all available SAS Model Manager projects within a repository","minEntries":1,"maxEntries":1,"defaultEntries":0,"type":"table","columnDelta":{"updateColumnArguments":["_mgp_id","_mgp_repositoryId","_mgp_name","_mgp_function","_mgp_status","_mgp_folderID","_mgp_createdBy","_mgp_creationTS","_mgp_modifiedBy","_mgp_modifiedTS"]},"supportsView":false,"requiresStructure":false}]},"ui":"{\n\t\"showPageContentOnly\": true,\n\t\"pages\": [\n\t\t{\n\t\t\t\"id\": \"pageDefinition\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"Definition\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgp_info_text\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"For the repository ID you can either connect a table, which has to have a column named id, that contains the repository ID or you can manually enter an ID value.\\n\\nConnect an output table that will contain all available projects in a SAS Model Manager repository in the SAS Viya environment, that you have access to.\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgp_input_selector\",\n\t\t\t\t\t\"type\": \"radiogroup\",\n\t\t\t\t\t\"label\": \"Choose how to enter the repository ID:\",\n\t\t\t\t\t\"items\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"table\",\n\t\t\t\t\t\t\t\"label\": \"Select ID from a table\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"value\": \"manual\",\n\t\t\t\t\t\t\t\"label\": \"Input an ID manually\"\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgp_rep_input\",\n\t\t\t\t\t\"type\": \"inputtable\",\n\t\t\t\t\t\"label\": \"Repository table:\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_mgp_input_selector\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgp_col\",\n\t\t\t\t\t\"type\": \"columnselector\",\n\t\t\t\t\t\"label\": \"Select repository ID column:\",\n\t\t\t\t\t\"include\": null,\n\t\t\t\t\t\"order\": false,\n\t\t\t\t\t\"columntype\": \"c\",\n\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\"min\": null,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_mgp_input_selector\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t],\n\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\"table\": \"_mgp_rep_input\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgp_repID_table\",\n\t\t\t\t\t\"type\": \"list\",\n\t\t\t\t\t\"label\": \"Select the repository ID:\",\n\t\t\t\t\t\"items\": {\n\t\t\t\t\t\t\"ref\": \"_mgp_col\"\n\t\t\t\t\t},\n\t\t\t\t\t\"max\": 1,\n\t\t\t\t\t\"min\": null,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_mgp_input_selector\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgp_repID_manual\",\n\t\t\t\t\t\"type\": \"textfield\",\n\t\t\t\t\t\"label\": \"Enter a repository ID:\",\n\t\t\t\t\t\"placeholder\": \"Repository ID\",\n\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\"visible\": [\n\t\t\t\t\t\t\"$_mgp_input_selector\",\n\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\"manual\"\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgp_output\",\n\t\t\t\t\t\"type\": \"outputtable\",\n\t\t\t\t\t\"label\": \"Output projects table:\",\n\t\t\t\t\t\"required\": true,\n\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"_mgp_output_definition\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Output definition\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": false,\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgp_id\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Project ID:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgp_repositoryId\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Repository ID:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgp_name\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Name:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgp_function\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Function:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgp_status\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Status:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgp_folderID\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Folder ID:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgp_createdBy\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Created by:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgp_creationTS\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Creation time stamp:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgp_modifiedBy\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Modified by:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"_mgp_modifiedTS\",\n\t\t\t\t\t\t\t\"type\": \"newcolumn\",\n\t\t\t\t\t\t\t\"label\": \"Modification time stamp:\",\n\t\t\t\t\t\t\t\"required\": false,\n\t\t\t\t\t\t\t\"placeholder\": \"\",\n\t\t\t\t\t\t\t\"hideproperties\": false,\n\t\t\t\t\t\t\t\"readonly\": false,\n\t\t\t\t\t\t\t\"visible\": false\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t},\n\t\t{\n\t\t\t\"id\": \"pageAbout\",\n\t\t\t\"type\": \"page\",\n\t\t\t\"label\": \"About\",\n\t\t\t\"children\": [\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"textAbout\",\n\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\"text\": \"MM - Get Projects in Repository step\\n==========\\n\\nThe \\\"MM - Get Projects in Repository\\\" custom steps performs a look up of all of the available  projects in a SAS Model Manager (MM) repository that the step user has access to.\\n\\nThis step requires as an input the ID of a repository, to retrieve a list of repository IDs use the MM - Get All Repositories step.\\n\\nThis steps output can be used as input for the step MM - Get Models in Project\",\n\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionPrereqs\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Pre-requisites\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textPrereqs\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"Pre-requisites:  Tested on Viya version Stable 2024.07\\n\\nSAS Model Manager has be licensed and the user has to have the capability to use SAS Model Manager.\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionDocumentation\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Documentation\",\n\t\t\t\t\t\"open\": false,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textDocumentation\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"* The following SAS Viya REST-API is used: https://developer.sas.com/rest-apis/modelRepository-v8?operation=getProjects\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\t\"id\": \"sectionChangelog\",\n\t\t\t\t\t\"type\": \"section\",\n\t\t\t\t\t\"label\": \"Changelog\",\n\t\t\t\t\t\"open\": true,\n\t\t\t\t\t\"visible\": \"\",\n\t\t\t\t\t\"children\": [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"id\": \"textChangelog\",\n\t\t\t\t\t\t\t\"type\": \"text\",\n\t\t\t\t\t\t\t\"text\": \"* Version: 1.0 (03AUG2024)\\n      - Initial version\",\n\t\t\t\t\t\t\t\"visible\": \"\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t],\n\t\"syntaxversion\": \"1.3.0\",\n\t\"values\": {\n\t\t\"_mgp_input_selector\": {\n\t\t\t\"value\": \"table\",\n\t\t\t\"label\": \"Select ID from a table\"\n\t\t},\n\t\t\"_mgp_rep_input\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"_mgp_col\": [],\n\t\t\"_mgp_repID_table\": [],\n\t\t\"_mgp_repID_manual\": \"\",\n\t\t\"_mgp_output\": {\n\t\t\t\"library\": \"\",\n\t\t\t\"table\": \"\"\n\t\t},\n\t\t\"_mgp_id\": {\n\t\t\t\"value\": \"id\",\n\t\t\t\"label\": \"ID of the project\",\n\t\t\t\"length\": 36\n\t\t},\n\t\t\"_mgp_repositoryId\": {\n\t\t\t\"value\": \"repositoryId\",\n\t\t\t\"label\": \"ID of the repository that the project is in\",\n\t\t\t\"length\": 36\n\t\t},\n\t\t\"_mgp_name\": {\n\t\t\t\"value\": \"name\",\n\t\t\t\"label\": \"Name of the project\",\n\t\t\t\"length\": 256\n\t\t},\n\t\t\"_mgp_function\": {\n\t\t\t\"value\": \"function\",\n\t\t\t\"label\": \"Function of the models in the project\",\n\t\t\t\"length\": 256\n\t\t},\n\t\t\"_mgp_status\": {\n\t\t\t\"value\": \"status\",\n\t\t\t\"label\": \"Indicates the current status of the project\",\n\t\t\t\"length\": 256\n\t\t},\n\t\t\"_mgp_folderID\": {\n\t\t\t\"value\": \"folderId\",\n\t\t\t\"label\": \"Folder ID of the project\",\n\t\t\t\"length\": 36\n\t\t},\n\t\t\"_mgp_createdBy\": {\n\t\t\t\"value\": \"createdBy\",\n\t\t\t\"label\": \"Project creator\",\n\t\t\t\"length\": 256\n\t\t},\n\t\t\"_mgp_creationTS\": {\n\t\t\t\"value\": \"creationTimeStamp\",\n\t\t\t\"label\": \"Time of project creation\",\n\t\t\t\"length\": 27\n\t\t},\n\t\t\"_mgp_modifiedBy\": {\n\t\t\t\"value\": \"modifiedBy\",\n\t\t\t\"label\": \"Last project modifier\",\n\t\t\t\"length\": 256\n\t\t},\n\t\t\"_mgp_modifiedTS\": {\n\t\t\t\"value\": \"modifiedTimeStamp\",\n\t\t\t\"label\": \"Time of last project modification\",\n\t\t\t\"length\": 27\n\t\t}\n\t}\n}","templates":{"SAS":"/**************************************************************\n    Get a list of Projects in a SAS Model Manager Repository\n\n    mgp is short for:\n      Model Manager Get Projects\n**************************************************************/\n* Get the Viya Host URL;\n%let _mgp_viyaHost=%sysfunc(getoption(SERVICESBASEURL));\n\n%if &_mgp_input_selector. EQ table %then %do;\n\t%let _mgp_repository_id = &_mgp_repid_table_1.;\n%end;\n%else %do;\n\t%let _mgp_repository_id = &_mgp_repid_manual.;\n%end;\n\n* Macro to recursivly get all projects;\n%macro _mgp_project_pagination(_mgp_start=0, _mgp_limit=25);\n    %local _mgp_start\n        _mgp_limit\n        _mgp_ds_nobs\n        _mgp_nvar\n        _mgp_new_start;\n\n    filename _mgp_rp temp;\n\n    * https://developer.sas.com/rest-apis/modelRepository-v8?operation=getProjects;\n    proc http method = 'Get'\n        url = \"&_mgp_viyaHost./modelRepository/projects?start=&_mgp_start%nrstr(&)limit=&_mgp_limit.%nrstr(&)filter=eq(repositoryId,'&_mgp_repository_id.')\"\n        oauth_bearer = sas_services\n        out = _mgp_rp;\n        headers 'Accept' = 'application/json';\n    quit;\n\n    libname _mgp_rp json;\n\n    * Get the number of observations where one obs = one project;\n    proc sql noprint;\n        select count(*) into :_mgp_ds_nobs trimmed from _mgp_rp.items;\n    quit;\n\n    * Get the number of columns;\n    proc sql noprint;\n        select nvar into :_mgp_nvar trimmed from dictionary.tables where\n            libname='_MGP_RP' and memname='ITEMS';\n    quit;\n\n    * Handle the first iteration and subsequent requests;\n    %if &_mgp_start. eq 0 %then %do;\n        data &_mgp_output.;\n            length name createdBy modifiedBy function status $256.;\n            set _mgp_rp.items(keep=id repositoryId name function status folderId createdBy creationTimeStamp modifiedBy modifiedTimeStamp);\n        run;\n    %end;\n    %else %do;\n        %if &_mgp_nvar. gt 2 %then %do;\n            proc append force nowarn base=&_mgp_output.\n                data=_mgp_rp.items(keep=id repositoryId name function status folderId createdBy creationTimeStamp modifiedBy modifiedTimeStamp);\n            quit;\n        %end;\n    %end;\n\n    libname _mgp_rp clear;\n    filename _mgp_rp clear;\n\n    * Check if another iteration is needed;\n    %if &_mgp_ds_nobs eq &_mgp_limit and &_mgp_nvar. gt 2 %then %do;\n        %put NOTE: Getting more projects;\n        %let _mgp_new_start=%eval(&_mgp_start. + &_mgp_limit.);\n        %_mgp_project_pagination(_mgp_start=&_mgp_new_start., _mgp_limit=&_mgp_limit.);\n    %end;\n%mend _mgp_project_pagination;\n\n* Get a table of all projects;\n%_mgp_project_pagination();\n\n* Clean up;\n%symdel _mgp_viyaHost _mgp_repository_id;\n%sysmacdelete _mgp_project_pagination;"}}